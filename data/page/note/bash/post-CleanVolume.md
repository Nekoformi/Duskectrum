---
title: Clean Volume
date: 2024/02
author: Nekoformi
---

# Clean Volume

コンピューターやストレージを破棄・譲渡する場合は、必ずデータを抹消しましょう。ファイルをゴミ箱から消去したりOSを初期化しても、データは完全に削除されていません。

## 準備

1. DVDやUSBメモリーを用いてライブ起動するストレージを作成します。
    1. Linuxディストリビューションのイメージファイルをダウンロードします。特に拘りがなければ[Ubuntu](https://ubuntu.com/download)や[Debian](https://www.debian.org/)といったメジャーなLinuxディストリビューションを選択しましょう。
    2. ストレージを起動可能にするソフトウェア（例えば[balenaEtcher](https://etcher.balena.io/)や[Rufus](https://rufus.ie/en/)等）を利用してストレージにイメージファイルを書き込みます。
    3. 対象のコンピューターを起動します。その際に、BIOSやUEFIから起動デバイスの選択、あるいは変更を行います。
    4. ライブ起動を選択してLinuxを立ち上げます。
    - 起動に失敗する場合は、異なるLinuxディストリビューションやバージョンを使用することで成功するかもしれません。
2. インターネットに接続します。
3. ターミナルを起動して必要なパッケージを入手します。
    - **GParted**：ボリュームを視覚的に編集します。

```sh:Bash
$ sudo apt -y install gparted
```

## ボリュームの全体領域を抹消

1. `lsblk`コマンドでデバイスの一覧を表示します。ここで、対象のパスを確認します。
2. 以下のコマンドでボリュームの内容を抹消します。
    - パスやオプションは場合に応じて変更してください。
    - SSD等のデバイスは仕様として不連続の内容を同じデータ領域（ブロック）に保存する可能性があるため、高品質なセキュリティーが要求される場合はSecure Eraseを用いて抹消するか、連続した乱数を出力するために次項の「ボリュームの空き領域を抹消」する必要があります。

```sh:Bash
$ sudo shred -n 1 -vz /dev/nvme0n1
```

## ボリュームの空き領域を抹消

1. 必要に応じてGPartedでパーティションテーブルとパーティションの作成を行います。
2. `df`コマンドでストレージの一覧を表示します。ここで、対象のパスと空き容量を確認します。
3. ダミーファイルを作成します。
    - 文字列に空白（` `）が含まれる場合は空白をエスケープ（`\ `）するか、引用符（`"`）で囲む必要があります。
    - パスやバッファリングサイズは場合に応じて変更してください。

```sh:Bash
$ sudo dd if=/dev/urandom of="/media/${USER}/Remove Volume/tempfile" bs=1k count=XXXXXXXX
```

4. ダミーファイルを抹消します。
    - パスやオプションは場合に応じて変更してください。

```sh:Bash
$ sudo shred -n 1 -vz "/media/${USER}/Remove Volume/tempfile"
```
